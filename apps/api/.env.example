# Loa Constructs API - Environment Variables
# @see sdd.md ยง11.D Environment Variables
# @see sprint.md T17.2: Minimum Required Environment Variables
#
# Copy to .env and fill in values
#
# Legend:
#   [REQUIRED] - Must be set for API to start
#   [OPTIONAL] - Can be omitted, feature will be disabled gracefully

# ============================================================
# REQUIRED - API will not start without these
# ============================================================

# --- Database (Neon) --- [REQUIRED]
# PostgreSQL connection string for Neon serverless database
DATABASE_URL=postgresql://user:password@host.neon.tech/dbname?sslmode=require

# --- JWT Authentication --- [REQUIRED]
# Secret key for signing JWT tokens (minimum 32 characters)
# Generate with: openssl rand -hex 32
JWT_SECRET=your-super-secret-key-at-least-32-chars

# --- Server --- [REQUIRED in production]
NODE_ENV=development
PORT=3000
HOST=0.0.0.0
LOG_LEVEL=debug

# ============================================================
# OPTIONAL - Features gracefully disabled if not set
# ============================================================

# --- JWT Issuer --- [OPTIONAL]
# URL of the API for token issuer claim
# Default: http://localhost:3000
JWT_ISSUER=https://api.constructs.network

# --- Redis (Upstash) --- [OPTIONAL]
# Used for: rate limiting, session cache, tier cache
# Fallback: in-memory storage (not recommended for production)
# REDIS_URL=redis://default:password@region.upstash.io:6379

# --- Storage (Cloudflare R2) --- [OPTIONAL]
# Used for: pack file storage
# Fallback: files stored in database (works but less efficient)
# R2_ACCOUNT_ID=your_account_id
# R2_ACCESS_KEY_ID=your_access_key
# R2_SECRET_ACCESS_KEY=your_secret_key
# R2_BUCKET=loa-constructs

# --- Stripe Billing --- [OPTIONAL]
# Used for: subscription payments
# Fallback: subscriptions granted manually via scripts
# Not needed for soft launch with thjBypass enabled
# STRIPE_SECRET_KEY=sk_test_...
# STRIPE_WEBHOOK_SECRET=whsec_...
# STRIPE_PRO_PRICE_ID=price_...
# STRIPE_TEAM_PRICE_ID=price_...

# --- OAuth: GitHub --- [OPTIONAL]
# Used for: GitHub login
# Fallback: email/password auth only
# GITHUB_CLIENT_ID=your_github_client_id
# GITHUB_CLIENT_SECRET=your_github_client_secret

# --- OAuth: Google --- [OPTIONAL]
# Used for: Google login
# Fallback: email/password auth only
# GOOGLE_CLIENT_ID=your_google_client_id
# GOOGLE_CLIENT_SECRET=your_google_client_secret

# --- Email (Resend) --- [OPTIONAL]
# Used for: email verification, password reset
# Fallback: emails skipped in development, error in production
# For soft launch: create users with emailVerified=true
# RESEND_API_KEY=re_...

# --- Monitoring --- [OPTIONAL]
# Used for: error tracking, analytics
# Fallback: errors logged to console only
# SENTRY_DSN=https://...@sentry.io/...
# POSTHOG_API_KEY=phc_...

# ============================================================
# SOFT LAUNCH MINIMUM CONFIGURATION
# ============================================================
# For a soft launch without billing, you only need:
#
# DATABASE_URL=postgresql://...
# JWT_SECRET=<64-char-random-string>
# NODE_ENV=production
#
# Then grant subscriptions manually:
#   npx tsx scripts/grant-subscription.ts user@example.com pro
