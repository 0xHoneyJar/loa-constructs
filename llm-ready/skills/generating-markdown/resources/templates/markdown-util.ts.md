# Markdown Utility Template

> Standalone markdown conversion utilities with TypeScript types.

## Template

```typescript
/**
 * Markdown Utilities
 *
 * Zero-dependency markdown generation for page content.
 * Generated by llm-ready pack.
 */

import type { PageContent, ContentSection } from './page-content';

/**
 * Convert structured page content to markdown string.
 * Includes YAML frontmatter for metadata.
 */
export function toMarkdown(page: PageContent): string {
  const lines: string[] = [];

  // YAML Frontmatter
  lines.push('---');
  lines.push(`title: "${escapeYaml(page.title)}"`);

  if (page.description) {
    lines.push(`description: "${escapeYaml(page.description)}"`);
  }

  if (page.lastUpdated) {
    lines.push(`last_updated: "${page.lastUpdated}"`);
  }

  if (page.author) {
    lines.push(`author: "${escapeYaml(page.author)}"`);
  }

  if (page.tags && page.tags.length > 0) {
    lines.push(`tags: [${page.tags.map(t => `"${escapeYaml(t)}"`).join(', ')}]`);
  }

  lines.push(`generated_at: "${new Date().toISOString()}"`);
  lines.push('---');
  lines.push('');

  // Title
  lines.push(`# ${page.title}`);
  lines.push('');

  // Description as lead paragraph
  if (page.description) {
    lines.push(`> ${page.description}`);
    lines.push('');
  }

  // Sections
  for (const section of page.sections) {
    lines.push(sectionToMarkdown(section));
    lines.push('');
  }

  return lines.join('\n').trim() + '\n';
}

/**
 * Convert a single section to markdown.
 */
function sectionToMarkdown(section: ContentSection): string {
  const lines: string[] = [];

  // Heading
  if (section.heading) {
    const hashes = '#'.repeat(section.level || 2);
    lines.push(`${hashes} ${section.heading}`);
    lines.push('');
  }

  // Content based on type
  switch (section.type) {
    case 'code':
      lines.push('```' + (section.language || ''));
      lines.push(section.content);
      lines.push('```');
      break;

    case 'list':
      // Assume content is newline-separated items
      const items = section.content.split('\n').filter(Boolean);
      for (const item of items) {
        lines.push(`- ${item}`);
      }
      break;

    case 'table':
      // Assume content is already markdown table format
      lines.push(section.content);
      break;

    case 'blockquote':
      const quoteLines = section.content.split('\n');
      for (const line of quoteLines) {
        lines.push(`> ${line}`);
      }
      break;

    case 'paragraph':
    default:
      lines.push(section.content);
      break;
  }

  return lines.join('\n');
}

/**
 * Escape special characters for YAML string values.
 */
function escapeYaml(str: string): string {
  return str
    .replace(/\\/g, '\\\\')
    .replace(/"/g, '\\"')
    .replace(/\n/g, '\\n')
    .replace(/\r/g, '\\r')
    .replace(/\t/g, '\\t');
}

/**
 * Create a simple PageContent object from basic inputs.
 * Useful for quick conversions.
 */
export function createPageContent(
  title: string,
  content: string,
  options: Partial<Omit<PageContent, 'title' | 'sections'>> = {}
): PageContent {
  return {
    title,
    sections: [{ type: 'paragraph', content }],
    ...options,
  };
}

/**
 * Extract plain text from markdown (simple implementation).
 * Removes headers, links, emphasis, etc.
 */
export function markdownToPlainText(markdown: string): string {
  return markdown
    // Remove frontmatter
    .replace(/^---[\s\S]*?---\n*/m, '')
    // Remove headers
    .replace(/^#+\s+/gm, '')
    // Remove bold/italic
    .replace(/\*\*([^*]+)\*\*/g, '$1')
    .replace(/\*([^*]+)\*/g, '$1')
    .replace(/__([^_]+)__/g, '$1')
    .replace(/_([^_]+)_/g, '$1')
    // Remove links, keep text
    .replace(/\[([^\]]+)\]\([^)]+\)/g, '$1')
    // Remove code blocks
    .replace(/```[\s\S]*?```/g, '')
    // Remove inline code
    .replace(/`([^`]+)`/g, '$1')
    // Clean up whitespace
    .replace(/\n{3,}/g, '\n\n')
    .trim();
}
```

## Placeholders

This template has no dynamic placeholders - it's used as-is.

## Usage Example

```typescript
import { toMarkdown, createPageContent } from '@/lib/markdown/to-markdown';
import type { PageContent } from '@/lib/markdown/page-content';

// Full structured content
const page: PageContent = {
  title: 'Pricing',
  description: 'Simple, transparent pricing.',
  lastUpdated: '2026-01-15',
  sections: [
    {
      heading: 'Plans',
      level: 2,
      type: 'paragraph',
      content: 'Choose the plan that works for you.',
    },
    {
      heading: 'Features',
      level: 2,
      type: 'list',
      content: 'Feature A\nFeature B\nFeature C',
    },
  ],
};

const markdown = toMarkdown(page);

// Or quick conversion
const quickPage = createPageContent(
  'Hello World',
  'This is a simple page.',
  { description: 'A greeting page' }
);
```

## Output Location

`lib/markdown/to-markdown.ts`

Or follows detected codebase conventions for utility locations.
